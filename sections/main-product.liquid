{%- liquid
  assign current_variant = product.selected_or_first_available_variant
  render 'product.head', current_variant: current_variant
-%}

<div class="product px-6 xl:px-16" data-component="productSelection">

  <div class="grid grid-cols-4 gap-1 rounded-sm">
    {%- for image in product.images -%}
      {% render 'component.picture', img: image %}
    {%- endfor -%}
  </div>

  {%- form 'product', product, class: 'product__form', data-component: "productForm" -%}
    <input type="hidden" name="quantity" value="1">

    {% for block in section.blocks %}
      {%- case block.type -%}
        {%- when 'title' -%}
          <h1 class="product__title">{{- product.title -}}</h1>
        {%- when 'prices' -%}
          {%- render 'component.price', product: current_variant, data_attributes: true -%}
        {%- when 'string' -%}
          <p class="product__text">{{- block.settings.text -}}</p>
        {%- when 'cta' -%}
          <button class="w-full xl:w-auto bg-indigo-600 py-4 px-6 rounded text-white font-semibold disabled:cursor-not-allowed disabled:opacity-50" type="submit" data-submit>{{- 'products.product.add_to_cart' | t -}}</button>
        {%- when 'variants' -%}
          {%- 
            render 'product.options',
            option_type: block.settings.type,
            current_variant: current_variant
          -%}
        {%- when 'tab' -%}
          {%- 
            render 'component.accordion', 
            title: block.settings.title,
            content: block.settings.content,
            active: block.settings.open,
            group: section.id
          -%}
        {%- when 'app' -%}
          {%- render block -%}
      {%- endcase -%}
    {% endfor %}
  {%- endform -%}
</div>

{% schema %}
  {
    "name": "Product",
    "blocks": [
      {
        "name": "Title",
        "type": "title",
        "limit": 1
      },
      {
        "name": "Prices",
        "type": "prices",
        "limit": 1
      },
      {
        "name": "Call-To-Action",
        "type": "cta",
        "limit": 1
      },
      {
        "name": "String",
        "type": "string",
        "settings": [
          {
            "type": "text",
            "id": "text",
            "label": "Text"
          }
        ]
      },
      {
        "name": "Variants",
        "type": "variants",
        "settings": [
          {
            "type": "select",
            "id": "type",
            "label": "Type",
            "options": [
              {
                "value": "radio",
                "label": "Radio"
              },
              {
                "value": "select",
                "label": "Select"
              }
            ],
            "default": "select"
          }
        ]
      },
      {
        "name": "Tab",
        "type": "tab",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Title"
          },
          {
            "type": "richtext",
            "id": "content",
            "label": "Content"
          },
          {
            "type": "checkbox",
            "id": "open",
            "label": "Open by default?",
            "info": "Only 1 tab can be open at a time"
          }
        ]
      },
      {
        "type": "@app"
      }
    ]
  }
{% endschema %}